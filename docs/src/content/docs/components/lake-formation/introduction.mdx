---
title: Introduction
description: Lake Formation - Introduction
---
import DualCode from '../../../../components/DualCode.astro';

DLZ comes with the option to enable [Lake Formation](https://docs.aws.amazon.com/lake-formation/latest/dg/what-is-lake-formation.html) (LF) in any of your accounts.

It's a service designed to help with data governance, data sharing, and manage permissions for secure data lakes. It can complement or replace IAM permissions in these contexts, providing an alternative layer of security and management capabilities.

If you're unfamiliar with Lake Formation, it is recommended you read [this brief intro guide](https://aws.github.io/aws-lakeformation-best-practices/).

## Getting Started

Having an effective and lean tag ontology is the most important thing when working with Lake Formation.

The following is a minimal, non production-ready example just to show how to get started. Later sections will cover best practices, important considerations, and potential pitfalls to be aware of.

<DualCode>
  <Fragment slot="ts">
  ```ts
    ...
    accounts: [
      {
        ...,
        lakeFormation: [{
          region: Region.EU_WEST_1,
          admins: ['arn:aws:iam::123456789012:role/Admin'],
          tags: [
            { tagKey: 'common', tagValues: ['true', 'false']}
            { tagKey: 'team:Data', tagValues: ['true'] }
          ],
          permissions: [
            {
              principals: ['arn:aws:iam::123456789012:role/TeamData'],
              tags: [{ tagKey: 'team:Data', tagValues: ['true'] }],
              databaseActions: [DatabaseAction.DESCRIBE],
              tableActions: [TableAction.DESCRIBE, TableAction.SELECT]
            }
          ]
        }]
      }
    ]
  ```
  </Fragment>
  <Fragment slot="python">
  ```python
    ...
    accounts = [
        dlz.DLzAccount(
            ...,
            lake_formation=[dlz.DlzLakeFormationProps(
                region=dlz.Region.EU_WEST_1,
                admins=['arn:aws:iam::123456789012:role/Admin'],
                tags=[
                    {'tag_key': 'common', 'tag_values': ['true', 'false']}
                    {'tag_key': 'team:Data', 'tag_values': ['true']}
                ],
                permissions=[
                    dlz.LakePermission(
                        principals=['arn:aws:iam::123456789012:role/TeamData'],
                        tags=[{'tag_key': 'team:Data', 'tag_values': ['true']}],
                        database_actions=[DatabaseAction.DESCRIBE],
                        table_actions=[TableAction.DESCRIBE, TableAction.SELECT],
                    )
                ]
            )]
        )
    ]
  ```
  </Fragment>
</DualCode>

## Settings

The `lakeFormation | lake_formation` attribute of the `DlzAccount` object is an array, where each element corresponds to the Lake Formation settings for a specific AWS region. This allows users the flexibility to configure Lake Formation across multiple regions, or to use a single element for configurations pertaining to just one region.

At the very least, each Lake Formation setting must include the following:

### `region`
Self explanatory. Specify the AWS region where Lake Formation should be activated.

### `admins`
It is essential to include at least an admin for Lake Formation. While DLZ automatically assigns the CDK execution role as an LF admin, you need to ensure at least one role that can be assumed by a human is also included. Failing to do so will leave you unable to utilize Lake Formation beyond the initial configuration.
:::note
In typical Lake Formation setups, administrators don't automatically gain permissions for tags created by other users or roles. Here, however, any administrator you specify is automatically granted permissions for all actions on any tag created via DLZ configs.
:::

### `tags`
The list of all tags keys and corresponding values to be created for use in Lake Formation.
> _✨ Note - When sharing data across accounts, additional steps are needed. Check the [cross-account sharing section](introduction#cross-account-sharing) for guidance._

### `permissions`
Here you define "grants". Each element of the array represents a set of allowed actions granted to one or more principals, upon a combination of tags and values.
> _✨ Note - When sharing data across accounts, additional steps are needed. Check the [cross-account sharing section](introduction#cross-account-sharing) for guidance._
:::caution
Defining permissions requires knowledge of how Lake Formation Tag Based Access Contorl (TBAC) works. Do not make assumptions, you will make mistakes and waste time. Do yourself a favor and go read [this brief explanation](https://aws.github.io/aws-lakeformation-best-practices/lf-tags/basics/) or [the included guide](./lf-tbac-strategy.mdx).
:::

## Cross-Account Sharing

Lake Formation enables users to share Data Catalog resources to external entities (IAM principals, AWS accounts, Organizations and organizational units).

This guide shows how to set up cross-account sharing in DLZ. You can apply the same steps to other entity types as well.

For a deep dive on how cross-account sharing works, refer to the [official AWS docs](https://docs.aws.amazon.com/lake-formation/latest/dg/cross-account-permissions.html).

---

In this example, we'll illustrate how to share resources with an external account within the same Organization, as would be the normal case in a DLZ setup.

Sharing with an external account is, in practice, no different than sharing with an internal entity: you grant it a set of allowed actions upon a combination of tags and values.

The only difference is that the external account must have **at least** `DESCRIBE` permission on any key:value pair used in the aforementioned grants.

In other words, let's assume that you created a tag `shared` with possible values `true` and `false`, and you want to give an external account read access on any Data Catalog resource that you tag with `shared: true`.

This operation consists of two steps. In pseudocode it looks like this:

```sql
-- Make account '678901234567' able to read tag `shared=true`
GRANT 'DESCRIBE' ON TAG shared=True TO '678901234567'

-- Make account '678901234567' able to read any data catalog resource
-- tagged with LF Tag: `shared=true`
GRANT 'DESCRIBE', 'SELECT' ON TAG EXPRESSION (shared=True) TO '678901234567'
```

In simple terms, to allow an account to view and access data from external resources based on a specific tag expression, the account must first have read permissions for the tags and their associated values.

This translates to the following DLZ configs:

<DualCode>
  <Fragment slot="ts">
  ```ts
    ...
    tags: [
      {
        tagKey: 'shared', tagValues: ['true', 'false'],
        share: {
          withExternalAccount: [{
            principals: ['678901234567'],
            tagActions: [TagAction.DESCRIBE],
            specificValues: ['true']
          }]
        }
      }
    ],
    permissions: [
      {
        principals: ['678901234567'],
        tags: [{ tagKey: 'shared', tagValues: ['true'] }],
        databaseActions: [DatabaseAction.DESCRIBE],
        tableActions: [TableAction.DESCRIBE, TableAction.SELECT]
      }
    ]
  ```
  </Fragment>
  <Fragment slot="python">
  ```python
    ...
    tags=[
        {
            'tag_key': 'shared', 'tag_values': ['true'],
            'share': {
                'with_external_account': [{
                    'principals': ['678901234567'],
                    'tag_actions': [TagAction.DESCRIBE],
                    'specific_values': ['true']
                }]
            }
        }
    ],
    permissions=[
        dlz.LakePermission(
            principals=['678901234567'],
            tags=[{'tag_key': 'shared', 'tag_values': ['true']}],
            database_actions=[DatabaseAction.DESCRIBE],
            table_actions=[TableAction.DESCRIBE, TableAction.SELECT],
        )
    ]
  ```
  </Fragment>
</DualCode>

## Next Steps

With this, you should be equipped with the necessary knowledge to get started using Lake Formation with DLZ.

But if you're not familiar with LF at all, we strongly recommend you read at least these two guides, especially if you haven't read the one recommended in the intro, which illustrate how the tag system works, and proposes a basic strategy to implement, respectively:

- [How Lake Formation Tag Based Access Control Works](./lf-tbac-guide)
- [Lake Formation TBAC recommended strategy](./lf-tbac-strategy)